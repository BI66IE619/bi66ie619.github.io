<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Simple Stakes Plinko</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #222;
    color: #eee;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0; padding: 20px;
    user-select: none;
  }
  #board {
    position: relative;
    width: 400px;
    height: 480px;
    background: #444;
    border-radius: 10px;
    margin-bottom: 20px;
  }
  .peg {
    position: absolute;
    width: 12px;
    height: 12px;
    background: #f5c518;
    border-radius: 50%;
  }
  .chip {
    position: absolute;
    width: 20px;
    height: 20px;
    background: #f54242;
    border-radius: 50%;
    transition: top 0.3s ease, left 0.3s ease;
    pointer-events: none;
    z-index: 10;
  }
  #slots {
    display: flex;
    justify-content: space-between;
    width: 400px;
  }
  .slot {
    width: 50px;
    height: 50px;
    background: #333;
    border: 2px solid #666;
    border-radius: 6px;
    text-align: center;
    line-height: 50px;
    font-weight: bold;
    user-select: none;
  }
  #message {
    margin-top: 15px;
    font-size: 18px;
  }
  #instructions {
    margin-bottom: 10px;
    font-size: 14px;
    color: #aaa;
  }
</style>
</head>
<body>

<h1>Simple Stakes Plinko</h1>
<div id="instructions">Click at the top to drop the chip</div>
<div id="board"></div>
<div id="slots"></div>
<div id="message"></div>

<script>
  const board = document.getElementById('board');
  const slotsDiv = document.getElementById('slots');
  const message = document.getElementById('message');

  const cols = 9;  // Number of columns for pegs and slots
  const rows = 12; // Number of rows of pegs
  const pegSpacingX = 44; // horizontal spacing of pegs
  const pegSpacingY = 36; // vertical spacing of pegs
  const pegRadius = 6;

  // Stakes for each slot - example values
  const stakes = [10, 20, 50, 100, 500, 100, 50, 20, 10];

  // Store pegs positions to draw pegs
  const pegs = [];

  // Draw pegs in a triangular offset pattern
  function setupPegs() {
    for(let row=0; row<rows; row++) {
      let offsetX = (row % 2 === 0) ? pegSpacingX/2 : 0;
      for(let col=0; col<cols; col++) {
        // skip pegs that go outside board width
        let x = col * pegSpacingX + offsetX;
        if (x < 10 || x > board.clientWidth - 10) continue;

        let y = row * pegSpacingY + 30;
        pegs.push({x, y});
        const pegEl = document.createElement('div');
        pegEl.classList.add('peg');
        pegEl.style.left = (x - pegRadius) + 'px';
        pegEl.style.top = (y - pegRadius) + 'px';
        board.appendChild(pegEl);
      }
    }
  }

  // Setup slots at the bottom with stakes labels
  function setupSlots() {
    for(let i=0; i<cols; i++) {
      const slot = document.createElement('div');
      slot.classList.add('slot');
      slot.textContent = stakes[i] ? '$' + stakes[i] : '$0';
      slotsDiv.appendChild(slot);
    }
  }

  // Chip drop and animation logic
  function dropChip(startX) {
    message.textContent = '';
    // Create chip element
    let chip = document.createElement('div');
    chip.classList.add('chip');
    board.appendChild(chip);

    // Calculate initial position (top of board)
    let chipX = startX;
    let chipY = 10;

    chip.style.left = (chipX - 10) + 'px'; // center chip (width/2=10)
    chip.style.top = chipY + 'px';

    // Simulate chip path down the rows
    let path = [chipX];
    let currentCol = Math.round(chipX / pegSpacingX);
    if (currentCol < 0) currentCol = 0;
    if (currentCol >= cols) currentCol = cols - 1;

    // Move chip row by row, randomly bouncing left or right
    let steps = [];
    let delay = 0;
    for(let row=0; row<rows; row++) {
      // On even rows, peg is offset, so alternate
      let moveRight = Math.random() < 0.5;
      if(row % 2 === 0) {
        currentCol += moveRight ? 1 : 0;
      } else {
        currentCol += moveRight ? 0 : -1;
      }
      // Clamp column
      currentCol = Math.max(0, Math.min(cols - 1, currentCol));
      let x = currentCol * pegSpacingX + ((row % 2 === 0) ? pegSpacingX/2 : 0);
      let y = (row + 1) * pegSpacingY + 30;

      steps.push({x, y});
    }

    // Animate chip moving down through steps
    function animateStep(i) {
      if(i >= steps.length) {
        // Landed in slot
        let slotIndex = currentCol;
        let winAmount = stakes[slotIndex] || 0;
        message.textContent = `You landed in slot ${slotIndex + 1} and won $${winAmount}!`;
        // Remove chip after a delay
        setTimeout(() => chip.remove(), 3000);
        return;
      }
      let step = steps[i];
      chip.style.left = (step.x - 10) + 'px';
      chip.style.top = step.y + 'px';

      setTimeout(() => animateStep(i + 1), 300);
    }

    animateStep(0);
  }

  // On click at the top of the board, drop chip at that horizontal position
  board.addEventListener('click', e => {
    let rect = board.getBoundingClientRect();
    let x = e.clientX - rect.left;
    if (x < 20) x = 20;
    if (x > rect.width - 20) x = rect.width - 20;
    dropChip(x);
  });

  setupPegs();
  setupSlots();
</script>

</body>
</html>
